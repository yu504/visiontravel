<!--
<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Unified Google Map</title>


<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCaJee3wWa3zhI4Lumrg7qMFOKos4Ki_3g"></script>

<style>
  html, body { height: 100%; margin: 0; padding: 0; font-family: Arial, sans-serif; }
  #map { height: 100%; width: 100%; }
  
  #settings-icon {
    position: absolute;
    top: 40px;
    right: 5px;
    cursor: pointer;
    font-size: 36px;
    color: #333;
    border-radius: 50%;
    padding: 10px;
    z-index: 10;
  }
  
  #settings-menu {
    position: absolute;
    top: 100px;
    right: 5px;
    background-color: white;
    border: 1px solid #ccc;
    padding: 10px;
    width: 200px;
    display: none;
    z-index: 20;
  }
  
  #settings-menu a {
    display: block;
    padding: 8px;
    text-decoration: none;
    color: black;
  }
  
  #settings-menu a:hover {
    background-color: #f0f0f0;
  }
</style>
</head>

<body>
  <div id="map"></div>

  <div id="settings-icon">âš™ï¸</div>

  <div id="settings-menu">
    <a href="/certification/upload" id="open-upload">ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</a>
    <a href="/user/login" id="logout">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</a>
  </div>

<script>
  // Google Mapsã®åˆæœŸåŒ–
  function initMap() {
    const mapOptions = {
      center: new google.maps.LatLng(35.6638, 138.5684),
      zoom: 15,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    new google.maps.Map(document.getElementById("map"), mapOptions);
  }

  // åˆæœŸåŒ–
  document.addEventListener("DOMContentLoaded", function() {
    initMap(); // ãƒãƒƒãƒ—ã‚’åˆæœŸåŒ–
  });

  // è¨­å®šãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’ãƒˆã‚°ãƒ«
  document.getElementById("settings-icon").addEventListener("click", function() {
    const menu = document.getElementById("settings-menu");
    menu.style.display = menu.style.display === "block" ? "none" : "block";
  });
</script>
</body>
</html>
-->

<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Sample_GoogleMap</title>
 
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCaJee3wWa3zhI4Lumrg7qMFOKos4Ki_3g&language={{ language_code }}"></script>
<style>
  html, body { height: 100%; margin: 0; padding: 0; }
  #map { height: 100%; width: 100%; }
 
  #search-bar {
    position: absolute;
    top: 10px;
    left: 50%;
    transform: translateX(-50%);
    width: 300px;
    z-index: 10;
    display: flex;
    align-items: center;
  }
 
  #search-input {
    width: 100%;
    padding: 8px;
    border: 1px solid #ccc;
    border-radius: 5px;
    padding-right: 30px; /* ã‚¢ã‚¤ã‚³ãƒ³åˆ†ã®ã‚¹ãƒšãƒ¼ã‚¹ã‚’è¿½åŠ  */
  }
 
  #search-icon {
    position: absolute;
    right: 10px; /* å³ç«¯ã«é…ç½® */
    cursor: pointer;
    font-size: 18px;
    color: #666;
  }
 
  #settings-icon {
    position: absolute;
    top: 50px; /* ç”»é¢æ‹¡å¤§ãƒãƒ¼ã‚¯ã®ä¸‹ã«é…ç½® */
    right: 0px;
    cursor: pointer;
    font-size: 36px; /* ã‚¢ã‚¤ã‚³ãƒ³ã‚’å¤§ããã™ã‚‹ */
    color: #333;
    border-radius: 50%;
    padding: 10px;
    z-index: 2; /* æ‹¡å¤§ãƒãƒ¼ã‚¯ã‚ˆã‚Šã‚‚ä¸‹ã«é…ç½® */
  }
 
  #settings-menu {
    position: absolute;
    top: 105px;
    right: 10px;
    background-color: white;
    border: 1px solid #ccc;
    padding: 10px;
    width: 200px;
    display: none;
    z-index: 20;
  }
 
  #settings-menu a {
    display: block;
    padding: 8px;
    text-decoration: none;
    color: black;
  }
 
  #settings-menu a:hover {
    background-color: #f0f0f0;
  }
 
  #upload-form {
    display: none;
    margin-top: 20px;
  }
 
  /* è¨€èªé¸æŠã®ã‚¹ã‚¿ã‚¤ãƒ« */
  #language-selector {
    position: absolute;
    top: 10px;
    left: 10px;
    z-index: 999;
    background: white;
    padding: 10px;
    border-radius: 5px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
  }
</style>
</head>
 
<div id="map"></div>
 
<!-- æ¤œç´¢ãƒãƒ¼ -->
<div id="search-bar">
  <input id="search-input" type="text" placeholder="search" />
  <span id="search-icon">ğŸ”</span> <!-- è™«çœ¼é¡ã‚¢ã‚¤ã‚³ãƒ³ -->
</div>

<!-- è¨­å®šã‚¢ã‚¤ã‚³ãƒ³ï¼ˆæ­¯è»Šãƒãƒ¼ã‚¯ï¼‰ -->
<div id="settings-icon">âš™ï¸</div>

<!-- è¨­å®šãƒ¡ãƒ‹ãƒ¥ãƒ¼ -->
<div id="settings-menu">
  <a href="/certification/upload?lang={{ language_code }}" id="open-upload"></a> <!-- Text will be dynamically set here -->
  <a href="/user/login" id="logout"></a> <!-- Text will be dynamically set here -->
</div>

<!-- ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒ  -->
<div id="upload-form">
  <h3>ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</h3>
  <input type="file" id="file-input" accept="image/*" />
  <button onclick="uploadImage()">ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</button>
  <p id="upload-result"></p>
</div>

<script>
  // åœ°å›³ã®åˆæœŸåŒ–
  var MyLatLng = new google.maps.LatLng(35.6638, 138.5684);
  var Options = {
      zoom: 15,
      center: MyLatLng,
      mapTypeId: 'roadmap'
  };
  var map = new google.maps.Map(document.getElementById('map'), Options);

  // æ¤œç´¢æ©Ÿèƒ½ã®è¿½åŠ 
  function searchLocation() {
      var address = document.getElementById('search-input').value;
      if (address) {
          var geocoder = new google.maps.Geocoder();

          geocoder.geocode({ 'address': address }, function(results, status) {
              if (status === 'OK') {
                  map.setCenter(results[0].geometry.location);
                  new google.maps.Marker({
                      map: map,
                      position: results[0].geometry.location
                  });
              } else {
                  alert('å ´æ‰€ã‚’è¦‹ã¤ã‘ã‚‰ã‚Œã¾ã›ã‚“ã§ã—ãŸ: ' + status);
              }
          });
      } else {
          alert('ä½æ‰€ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚');
      }
  }

  // ğŸ” ã‚¢ã‚¤ã‚³ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
  document.getElementById('search-icon').addEventListener('click', function() {
      searchLocation();
  });

  // Enter ã‚­ãƒ¼ã‚’æŠ¼ã—ãŸã¨ãã®ã‚¤ãƒ™ãƒ³ãƒˆ
  document.getElementById('search-input').addEventListener('keypress', function(event) {
      if (event.key === 'Enter') {
          searchLocation();
      }
  });

  // è¨­å®šã‚¢ã‚¤ã‚³ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
  document.getElementById('settings-icon').addEventListener('click', function() {
      var menu = document.getElementById('settings-menu');
      menu.style.display = (menu.style.display === 'block') ? 'none' : 'block';
  });

  // ãƒ­ã‚°ã‚¢ã‚¦ãƒˆãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
  document.getElementById('logout').addEventListener('click', function(event) {
      event.preventDefault();
      alert('ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸ');
      window.location.href = '/user/login';
  });

  // ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸç”»åƒã‚’å‡¦ç†ã™ã‚‹é–¢æ•°
  function uploadImage() {
      var fileInput = document.getElementById('file-input');
      var resultText = document.getElementById('upload-result');

      if (fileInput.files && fileInput.files[0]) {
          var file = fileInput.files[0];
          var reader = new FileReader();

          reader.onload = function(e) {
              resultText.innerHTML = 'ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ãŸç”»åƒ: <br><img src="' + e.target.result + '" width="200" />';
          };
          reader.readAsDataURL(file);
      } else {
          resultText.innerHTML = 'ç”»åƒãŒé¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚';
      }
  }

  let currentLanguage = "{{ language_code }}";  // Django ã‹ã‚‰å—ã‘å–ã£ãŸè¨€èªã‚³ãƒ¼ãƒ‰
  console.log("Django ã‹ã‚‰å—ã‘å–ã£ãŸ language_code:", currentLanguage);  // ãƒ‡ãƒãƒƒã‚°ç”¨

  // è¨€èªã«å¿œã˜ã¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’æ›´æ–°ã™ã‚‹é–¢æ•°
  function updateMenuText(language) {
      const menuItems = {
          ja: {  // æ—¥æœ¬èª
              uploadText: "ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰",
              historyText: "å±¥æ­´è¡¨ç¤º",
              settingsText: "ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å¤‰æ›´ãƒ»å‰Šé™¤",
              logoutText: "ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ",
              languageText: "è¨€èªé¸æŠ"
          },
          en: {  // è‹±èª
              uploadText: "Image Upload",
              logoutText: "Logout",
          }
          // ä»–ã®è¨€èªã‚‚è¿½åŠ ã§ãã¾ã™
      };

      const text = menuItems[language] || menuItems['en']; // è¨€èªãŒæŒ‡å®šã•ã‚Œã¦ã„ãªã„å ´åˆã¯è‹±èª

      // ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®ã«ãƒ†ã‚­ã‚¹ãƒˆã‚’è¨­å®š
      document.getElementById('open-upload').textContent = text.uploadText;
      document.getElementById('logout').textContent = text.logoutText;
  }

  // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å¾Œã«ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’æ›´æ–°
  document.addEventListener("DOMContentLoaded", function() {
      updateMenuText(currentLanguage);
      loadGoogleMapsScript(currentLanguage);
  });

  function loadGoogleMapsScript(language) {
      console.log("Google Maps ã®è¨€èªã‚’æ›´æ–°:", language);

      let oldScript = document.querySelector('script[src*="maps.googleapis.com"]');
      if (oldScript) {
          oldScript.remove();
      }

      document.getElementById("map").innerHTML = ""; // æ—¢å­˜ã®ãƒãƒƒãƒ—ã‚’ã‚¯ãƒªã‚¢

      const script = document.createElement('script');
      script.src = `https://maps.googleapis.com/maps/api/js?key=AIzaSyCaJee3wWa3zhI4Lumrg7qMFOKos4Ki_3g&language=${language}`;
      script.async = true;
      script.defer = true;

      script.onload = function() {
          initMap();  // ãƒãƒƒãƒ—ã‚’å†æç”»
      };

      document.head.appendChild(script);
  }

  function initMap() {
      const MyLatLng = new google.maps.LatLng(35.6638, 138.5684);
      const Options = {
          zoom: 15,
          center: MyLatLng,
          mapTypeId: 'roadmap'
      };
      var map = new google.maps.Map(document.getElementById('map'), Options);
  }

  window.onload = () => {
      initMap();  // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ãƒãƒƒãƒ—ã‚’åˆæœŸåŒ–
  };
</script>
</body>